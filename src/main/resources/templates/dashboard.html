<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org ">
<head>
    <meta charset="UTF-8">
    <title>借书用户界面</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" type="text/css" href="css/dashboard.css">
</head>
<body>
<div id="borrowOverlay" class="overlay" style="display: none;">
    <div id="borrow-content" class="overlay-content">
        <h2 id="borrow-title">书名</h2>
        <p id="borrow-author">作者：xxx</p>
        <p id="borrow-type">类型：xxx</p>
        <p id="borrow-publisher">出版社：xxx</p>
        <p id="borrow-number">剩余数量：xxx</p>
        <p id="borrow-desc">简介：xxx</p>
        <form action="/borrow" method="post" style="float: left; padding-left: 17%;">
            <input id="borrowBookId" name="bookid" type="hidden" />
            <button id="borrowButton">📖 借阅</button>
        </form>
        <button onclick="closeBorrowOverlay()">❌ 关闭</button>
    </div>
</div>
<div id="returnOverlay" class="overlay" style="display: none;">
    <div id="return-content" class="overlay-content">
        <h2 id="return-title">书名</h2>
        <p id="return-author">作者：xxx</p>
        <p id="return-type">类型：xxx</p>
        <p id="return-publisher">出版社：xxx</p>
        <p id="return-number">剩余数量：xxx</p>
        <p id="return-desc">简介：xxx</p>
        <form action="/borrow" method="post" style="float: left; padding-left: 17%;">
            <input id="returnBookid" name="bookid" type="hidden" />
            <button id="returnButton">📖 归还</button>
        </form>
        <button onclick="closeReturnOverlay()">❌ 关闭</button>
    </div>
</div>
<!-- 提示框：借阅失败（已借阅） -->
<div id="Borrowed" th:if="${Borrowed}" class="overlay">
    <div class="overlay-content">
        <p> 借阅失败：您已经借阅过该书</p>
        <button onclick="closeBorrowedOverlay()">❌ 关闭</button>
    </div>
</div>

<div class="sidebar">
    <h2>用户菜单</h2>
    <button class="nav-btn active" onclick="showSection('books')">📚 图书目录</button>
    <button class="nav-btn" onclick="showSection('mybook')">📚 已借到的图书</button>
    <button class="nav-btn" onclick="showSection('records')">📝 借阅记录</button>
    <button class="nav-btn" onclick="showSection('profile')">👤 我的信息</button>
    <a th:href="@{/logout}"><button class="nav-btn" onclick="logout()">🔓 退出登录</button></a>
</div>

<div class="main-content">
    <div id="books" class="content-section active">
        <h3>📚 图书目录</h3>
        <div class="book-list">
            <div class="book-card"
                 th:each="book : ${books}"
                 th:attr="data-bookid=${book.id},
                          data-title=${book.bookName},
                          data-author=${book.author},
                          data-type=${book.bookType},
                          data-publisher=${book.publisher},
                          data-number=${book.bookNumber},
                          data-desc=${book.description}"
                 onclick="ClickBookCard(this)" >
                <h4 th:text="${book.bookName}"></h4>
                <p><span th:text="${book.author}"></span> - 数量:<span th:text="${book.bookNumber}"></span></p>
            </div>
        </div>
    </div>

    <div id="records" class="content-section">
        <h3>📝 借阅记录</h3>
        <p>1.《三体》 借出日期：2025-04-01，归还日期：2025-04-10</p>
        <p>2.《活着》 借出日期：2025-03-10，已归还</p>
    </div>

    <div id="mybook" class="content-section">
        <h3>📚 已借到的图书</h3>
        <div class="book-list">
            <div class="book-card" th:each="book : ${userbooks}" >
                <h4 th:text="${book.bookName}"></h4>
                <p><span th:text="${book.author}"></span></span></p>
            </div>
        </div>
    </div>

    <div id="profile" class="content-section">
        <h3>👤 我的信息</h3>
        <p>用户名：<span th:text="${session.user.username}"></span></p>
        <p>电话：<span th:text="${session.user.phone}"></span></p>
        <p>邮箱：<span th:text="${session.user.email}"></span></p>
        <button onclick="toggleEditForm()">修改信息</button>
        <button onclick="toggleEditPasswdForm()">修改密码</button>
        <div id="editForm" class="info-edit-form" style="display: none;">
            <h4>修改信息</h4>
            <form action="/doChangeInfo" method="post">
                <input name="newPhone" type="text" placeholder="新手机号" th:value="${session.user.phone}" /><br>
                <input name="newEmail" type="email" placeholder="新邮箱" th:value="${session.user.email}" /><br>
                <button onclick="alert('信息已提交！');">提交</button>
            </form>
        </div>
        <div id="editPasswordForm" class="info-edit-form" style="display: none;">
            <h4>密码</h4>
            <form action="/doChangePassword" method="post">
                <input id="password1" name="newPasswd" type="password" placeholder="新密码" /><br>
                <input id="password2" type="password" placeholder="确认密码" /><br>
                <button>提交</button>
            </form>
        </div>
    </div>
</div>

<script src="js/dashboard.js"> </script>
</body>
</html>

